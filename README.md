# 1차년도 | 경희대학교  
**Few-shot Learning 객체 탐지 기술 연구 및 개발 (Cross-Domain)**

![python](https://img.shields.io/badge/Python-3.10%2B-blue)
![pytorch](https://img.shields.io/badge/PyTorch-2.x-red)
![cuda](https://img.shields.io/badge/CUDA-12.x-brightgreen)
![os](https://img.shields.io/badge/OS-Ubuntu%2020.04%2B-lightgrey)
![license](https://img.shields.io/badge/License-TBD-lightgrey)

> **TL;DR**  
> 실제 환경은 카메라·조명·배경·스타일이 제각각이라 **도메인이 계속 바뀝니다**.  
> 새로운 도메인마다 **대량 라벨링은 비현실적**이므로, **적은 데이터(= few-shot)** 만으로  
> **다른 도메인(= cross-domain)** 에 **빠르게 적응하는 객체 탐지 모델**이 필요합니다.  
> 이 저장소는 1차년도(경희대학교)의 **프로토콜·코드·벤치마크**를 제공합니다.

---

## 목차
- [문제 상황](#문제-상황)
- [기존 방식의 한계](#기존-방식의-한계)
  - [객체 탐지](#객체-탐지)
  - [퓨샷 객체 탐지](#퓨샷-객체-탐지)
  - [교차 도메인](#교차-도메인)
- [프로젝트 명](#프로젝트-명)
- [프로젝트 개요](#프로젝트-개요)
- [프로젝트 정보](#프로젝트-정보)
- [연구 목표](#연구-목표)
  - [핵심 목표](#핵심-목표)
  - [기술적 접근 방법](#기술적-접근-방법)
- [데이터셋](#데이터셋)
- [예상 성과 (1차년도)](#예상-성과-1차년도)
- [기술 스택](#기술-스택)
- [연구 개발 내용 (1차년도)](#연구-개발-내용-1차년도)
- [주요 응용 분야](#주요-응용-분야)
- [사사 문구](#사사-문구)
- [인용 (Citation)](#인용-citation)
- [문의](#문의)
- [라이선스](#라이선스)

---

## 문제 상황
실제 환경에서는 **도메인마다 이미지의 스타일/배경/센서 특성**이 다릅니다.  
새로운 도메인을 만날 때마다 **대량 라벨링을 수행하는 것은 비현실적**입니다.  
따라서 **적은 데이터(= few-shot)** 만으로 **다른 도메인(= cross-domain)** 에 **빠르게 적응**하는 객체 탐지 모델이 필요합니다.

---

## 기존 방식의 한계

### 객체 탐지
- 표준 객체 탐지 모델은 학습 도메인에 최적화되어 **새로운 환경에서 성능 급락**이 빈번합니다.

### 퓨샷 객체 탐지
- 소량 데이터 적응을 전제하지만 **도메인 변화** 자체는 고려하지 않아  
  **도메인 차이**가 큰 현장에서는 **일관된 성능 유지가 어려움**.

### 교차 도메인
- 도메인 변화는 고려하지만 **라벨이 적은(few-shot) 상황**을 전제하지 않아  
  **처음 보거나 충분히 보지 못한 객체에서 성능이 급락**합니다.

---

## 프로젝트 명
**Few-shot Learning 객체 탐지 기술 연구 및 개발**

---

## 프로젝트 개요
본 프로젝트는 **소량 라벨**로 **새로운 도메인**에 **신속하게 적응**하는 **객체 탐지** 방법론과  
**표준화된 벤치마크/평가 절차/코드베이스**를 구축하는 것을 목표로 합니다.  
1차년도에는 **문제정의 → 프로토콜 → 베이스라인 → 핵심 기법 → 재현 체계**를 완성합니다.

```
flowchart LR
    A[Source Domain (충분한 라벨)] --> B[기본 탐지기 학습]
    C[Target Domain (소량 라벨 k-shot)] --> D[도메인 적응 + Few-shot 미세학습]
    B --> D
    D --> E[공정한 벤치마크/평가 (mAP, AP50)]
    E --> F[실사용 시나리오 적용]
```

---

## 프로젝트 정보
- **기관**: 경희대학교 연구팀  
- **범위**: **1차년도** (본 레포지토리는 경희대학교 수행분만 포함)  
- **주요 산출물(1차년도)**:  
  - Cross-domain **few-shot 탐지** 벤치마크 프로토콜  
  - 재현 가능한 **학습/평가 코드** 및 **실험 설정(config)**  
  - **베이스라인 성능** 및 **제안 기법 성능** 보고

> ※ 참여기관/일정/담당자 정보는 공개 가능 범위 내에서 추후 업데이트됩니다.

---

## 연구 목표

### 핵심 목표
1. **Few-shot × Cross-domain** 객체 탐지 **통합 프레임워크** 수립  
2. **소량 라벨(k=1/3/5/10)** 환경에서의 **성능 격차**(기존 대비) **8–12 mAP** 개선 *(1차년도 목표치)*  
3. **재현성** 확보: 공개 설정, 고정된 seed, 명시적 샘플링 프로토콜 제공

### 기술적 접근 방법
- **파라미터 효율 미세적응(PEFT)**: LoRA/Adapter/Prompt-tuning으로 **빠른 적응·저비용 업데이트**
- **에피소드 기반 메타러닝**: N-way K-shot 에피소드로 **신규 클래스/도메인 일반화**
- **특징 정렬/도메인 불변화**: Adversarial feature alignment, style-transfer 보조 학습
- **자기학습/반지도**: pseudo-labeling + confidence filtering로 타깃 적응 보완
- **강건 증강**: 배경/스타일/조명 변이, domain randomization

---

## 데이터셋
> 1차년도는 **범용 소스 도메인**과 **이질적 타깃 도메인**을 선정하여 **k-shot 프로토콜**을 확정합니다.

- **소스(Source)**: COCO / VOC (대규모 라벨, 기본 탐지기 학습)
- **타깃(Target, Cross-domain)** 예시:
  - **Clipart / Watercolor / Comic** (스타일 변화)
  - **Cityscapes / Foggy Cityscapes / BDD100K** (도로·기상·야간 등 환경 변화)
  - **SIM10k → Cityscapes(차량)** (시뮬→현실 전이)
  - **항공/Aerial(예: DOTA 일부)** (관측각·해상도 차이)

**Few-shot 프로토콜**
- **k ∈ {1, 3, 5, 10}** per class, **고정 seed**로 에피소드 샘플링
- 샘플링: **랜덤 + 다양성 보장**(클래스·배경 분포 고려)
- 평가: **mAP@[0.5:0.95]**, **AP50**, **신규 클래스/도메인 분리 보고**

---

## 예상 성과 (1차년도)
- **벤치마크/코드 공개**: 표준화된 설정·스크립트·로그 체계
- **성능 목표**(예시, 5-shot):
  - **일반 베이스라인** 대비 타깃 도메인 **+8–12 mAP**  
  - 극저샷(1–3 shot)에서도 **안정적 수렴**과 **개선 폭** 확인
- **아블레이션**: PEFT vs Full-FT, 메타러닝 유무, 정렬 모듈/증강 조합

> 실제 수치는 데이터셋·클래스 구성에 따라 변동될 수 있으며, 모든 수치는 `results/`에 투명하게 공개합니다.

---

## 기술 스택
- **Framework**: PyTorch 2.x, CUDA 12.x  
- **Detection**: Faster R-CNN / RetinaNet / (선택) Deformable-DETR / YOLO 계열  
- **Config/런처**: Hydra 또는 argparse 기반 다중 설정  
- **로깅**: TensorBoard / CSV / (선택) Weights & Biases  
- **유틸**: Albumentations(증강), OpenCV, NumPy

---

## 연구 개발 내용 (1차년도)
- **WP1. 문제정의 & 지표**: 도메인/클래스 스코프, mAP 지표, 에피소드 샘플링 규칙
- **WP2. 데이터 파이프라인**: 소스/타깃 로더, k-shot 샘플러, 증강/전처리
- **WP3. 베이스라인 재현**: Faster R-CNN/YOLO 기본선 확보, 공정한 학습/평가 루틴
- **WP4. 핵심 기법 구현**
  - PEFT(LoRA/Adapter/Prompt) 모듈
  - 메타러닝(에피소드 학습) + 프로토타입 기반 분류기
  - 도메인 정렬(Adversarial, style 보조)
  - 자기학습(pseudo-labeling) 파이프라인
- **WP5. 아블레이션/분석**: 모듈별 기여도, 데이터 크기/샷 수 민감도, 오류 모드 분석
- **WP6. 재현성/배포**: 고정 seed, config 스냅샷, 결과 리포트/테이블 자동화

---

## 주요 응용 분야
- **제조**: 설비/라인/조명 변경 시 불량 탐지기 빠른 이식
- **리테일**: 매장/진열/배경 상이 시 상품/태그 인식
- **자율주행/교통**: 도시·기상·야간 전환 시 객체 인식 강건화
- **보안/감시**: 카메라/렌즈/설치각도 변화 대응
- **의료/리모트센싱**: 기기/프로토콜/관측각 상이 환경에서 라벨 절감 *(도메인 규정·윤리 준수 필수)*

---

## 사사 문구
본 프로젝트는 **한국산업기술기획평가원 연구개발 지원사업**의 지원을 받아 수행됩니다 **(과제번호: RS-2024-00442120)**.

---

## 문의
- 경희대학교 연구팀 (담당자/이메일 추후 업데이트)

---

## 라이선스
- **TBD** (기관 정책에 따라 MIT/BSD-3-Clause/Apache-2.0 등 결정하여 `LICENSE` 파일 추가)

---

본 연구는 CD-VITO를 참고하였음.
